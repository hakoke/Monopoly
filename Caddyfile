{
	auto_https off
	admin off
}

:{$PORT:3000} {
	root * /app/docs
	encode gzip
	
	# Log all requests for debugging
	log {
		output stdout
		format console
		level INFO
	}
	
	# Rewrite /Monopoly/assets/* requests to /assets/* (handles mismatched base paths from GitHub Pages builds)
	handle /Monopoly/assets/* {
		rewrite * /assets{path}
		file_server
	}
	
	# Rewrite /Monopoly/ requests to root (if HTML was built with /Monopoly/ base)
	handle /Monopoly {
		redir * / permanent
	}
	
	# Serve all static files directly (assets, fonts, images, etc.)
	@staticFiles {
		path_regexp \.(html|css|js|json|png|jpg|jpeg|gif|svg|ico|woff|woff2|ttf|eot|mp3|mp4|webm|pdf)$
	}
	handle @staticFiles {
		file_server
	}
	
	# For all other routes (SPA routing), serve index.html
	handle {
		try_files {path} /index.html
		file_server
	}
}

